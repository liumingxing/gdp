<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" >
<!--
 * FCKeditor - The text editor for Internet - http://www.fckeditor.net
 * Copyright (C) 2003-2009 Frederico Caldeira Knabben
 *
 * == BEGIN LICENSE ==
 *
 * Licensed under the terms of any of the following licenses at your
 * choice:
 *
 *  - GNU General Public License Version 2 or later (the "GPL")
 *    http://www.gnu.org/licenses/gpl.html
 *
 *  - GNU Lesser General Public License Version 2.1 or later (the "LGPL")
 *    http://www.gnu.org/licenses/lgpl.html
 *
 *  - Mozilla Public License Version 1.1 or later (the "MPL")
 *    http://www.mozilla.org/MPL/MPL-1.1.html
 *
 * == END LICENSE ==
 *
 * Smileys (emoticons) dialog window.
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title></title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="robots" content="noindex, nofollow" />
	<style type="text/css">
		.Hand
		{
			cursor: pointer;
			cursor: hand;
		}
		
.tabpage ul{
  margin:3px 0 3px 2px;
}		
.tabpage ul li {
margin-left: 2px;
margin-bottom: 0;
padding: 2px 5px 5px;
border: 1px solid #000;
list-style: none;//*不显示列表符号*//
display: inline;//*取消项目之间的分行*//
background-color: #CCCCCC;
cursor:pointer;
}

.tabpage ul li.selected {//*设定被选中的列表的效果*//
border-bottom: 1px solid #fff;
background-color: #fff;
}

	</style>
	<script src="common/fck_dialog_common.js" type="text/javascript"></script>
	<script type="text/javascript">

var dialog	= window.parent ;
var oEditor = dialog.InnerDialogLoaded() ;

window.onload = function ()
{
	// First of all, translate the dialog box texts
	oEditor.FCKLanguageManager.TranslatePage(document) ;

	// Show the "Ok" button.
	dialog.SetOkButton( true ) ;
	dialog.SetAutoSize( true ) ;
}

function Ok()
{
	oEditor.FCKUndo.SaveUndoStep() ;

	var param = {};
	var t = document.getElementsByName('itemtype');
	for(var i=0;i<t.length;i++){
	  if(t[i].checked){
	    param.itemType=parseInt(t[i].value,10);
		break;
	  }
	}

	switch(param.itemType){
	  case 1:
	    param.inputSize=parseInt(document.getElementById('shurukuangdaxiao').value,10);
		if(!param.inputSize){
		  param.inputSize=0;
		}
		t = document.getElementsByName('tiankongitem');
		for(var i=0;i<t.length;i++){
		  if(t[i].checked){
			param.inputItem=t[i];
			break;
		  }
		}
		var oImg = oEditor.FCK.InsertElement( 'input' ) ;
		oImg.name = param.inputItem.value ;
		oImg.className = 'tag' ;
		oImg.setAttribute('datatype', param.inputItem.getAttribute('datatype'));
		oImg.title = param.inputItem.getAttribute('cnname') ;
		oImg.type = "text";
		oImg.size = param.inputSize ;
		oImg.style.borderTop = '0';
		oImg.style.borderRight = '0';
		oImg.style.borderBottom = '1px solid black';
		oImg.style.borderLeft = '0';
	    break;
	  case 2:
	    var oImg = oEditor.FCK.InsertElement( 'span' ) ;
		oImg.innerHTML = '<table class="tag" border="1" cellspacing="0" cellpadding="0"><thead><tr><th datatype="int">序号</th><th datatype="text">产品名称</th><th datatype="text">企业名称</th><th datatype="text">注册商标</th><th datatype="text">规格型号</th></tr></thead><tbody><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><input type="button" value="增加一行" onclick="" />';
	    break;
	  case 3:
	    var oImg = oEditor.FCK.InsertElement( 'span' ) ;
		oImg.innerHTML = '<input type="button" value="添加图片" onclick="" />';
	    break;
	  case 4:
	    var oImg = oEditor.FCK.InsertElement( 'span' ) ;
		oImg.innerHTML = '<input type="button" value="添加文档" onclick="" />';
	    break;
	}
	

	// For long smileys list, it seams that IE continues loading the images in
	// the background when you quickly select one image. so, let's clear
	// everything before closing.
	document.body.innerHTML = '' ;

	dialog.Cancel() ;
}


function over(td)
{
	td.className = 'LightBackground Hand' ;
}

function out(td)
{
	td.className = 'DarkBackground Hand' ;
}

function selItemtype(o){

   if(o.value=='1'){
      document.getElementById('tiankong').style.display = 'block';
      document.getElementById('biaoge').style.display = 'none';
      document.getElementById('tupian').style.display = 'none';
      document.getElementById('wendang').style.display = 'none';
   }else if(o.value=='2'){
      document.getElementById('tiankong').style.display = 'none';
      document.getElementById('biaoge').style.display = 'block';
      document.getElementById('tupian').style.display = 'none';
      document.getElementById('wendang').style.display = 'none';
   }else if(o.value=='3'){
      document.getElementById('tiankong').style.display = 'none';
      document.getElementById('biaoge').style.display = 'none';
      document.getElementById('tupian').style.display = 'block';
      document.getElementById('wendang').style.display = 'none';
   }else if(o.value=='4'){
      document.getElementById('tiankong').style.display = 'none';
      document.getElementById('biaoge').style.display = 'none';
      document.getElementById('tupian').style.display = 'none';
      document.getElementById('wendang').style.display = 'block';
   }
}

//param:li element,itemtype,isDefined=1
function qiehuan(oli,itemtype,isDefined){
  for(var i=0;i<oli.parentNode.childNodes.length;i++){
    oli.parentNode.childNodes[i].className='';
  }
  oli.className='selected';
  
  if(isDefined == 1){
    document.getElementById('changyong'+itemtype).style.display='block';
    document.getElementById('zidingyi'+itemtype).style.display='none';
  }else{
    document.getElementById('changyong'+itemtype).style.display='none';
    document.getElementById('zidingyi'+itemtype).style.display='block';
  }
}

function biaogeshujuleixingdingyi(slt){
  var jedx;
  for(var i=0;i < slt.parentNode.childNodes.length;i++){
    if(slt.parentNode.childNodes[i].className=='jinedaxie'){
	    jedx = slt.parentNode.childNodes[i];
		break;
	}
  }
  if(slt.value=='money'){
    jedx.style.display='';
  }else{
    jedx.style.display='none';
  }
}
	</script>
</head>
<body style="overflow: hidden">
<input type="radio" name="itemtype" value="1" onClick="selItemtype(this)" checked="checked"/>填空项
<input type="radio" name="itemtype" value="2" onClick="selItemtype(this)"/>表格
<input type="radio" name="itemtype" value="3" onClick="selItemtype(this)"/>图片附件
<input type="radio" name="itemtype" value="4" onClick="selItemtype(this)"/>文档附件

<div id="tiankong" style="background:#ffffff;">
填空项长度：<input type="text" id="shurukuangdaxiao" name="shurukuangdaxiao" value="20"/>
<div class="tabpage">
<ul>
<li class="selected" onClick="qiehuan(this,'tiankong',1);">常用填空项</li>
<li onClick="qiehuan(this,'tiankong',2);">自定义</li>
</ul>
</div>
<div id="changyongtiankong">
<table width="100%" border="1" cellspacing="0">
  <tr>
    <th scope="col">&nbsp;</th>
    <th scope="col">序号&nbsp;</th>
    <th scope="col">填空项名称&nbsp;</th>
  </tr>
  <tr>
    <td>&nbsp;<input name="tiankongitem" type="radio" value="toubiaorenquancheng" cnname="投标人全称" datatype="text" checked /></td>
    <td>&nbsp;1</td>
    <td>&nbsp;投标人全称</td>
  </tr>
  <tr>
    <td>&nbsp;<input name="tiankongitem" type="radio" value="toubiaorendaibiaoxingming" cnname="投标人代表姓名" datatype="text" /></td>
    <td>&nbsp;2</td>
    <td>&nbsp;投标人代表姓名</td>
  </tr>
  <tr>
    <td>&nbsp;<input name="tiankongitem" type="radio" value="zhiwuzhicheng" cnname="职务、职称" datatype="text" /></td>
    <td>&nbsp;3</td>
    <td>&nbsp;职务、职称</td>
  </tr>
  <tr>
    <td>&nbsp;<input name="tiankongitem" type="radio" value="xiangmumingchengbianhaobaohao" cnname="项目名称、项目编号、包号" datatype="text" /></td>
    <td>&nbsp;4</td>
    <td>&nbsp;项目名称、项目编号、包号</td>
  </tr>
  <tr>
    <td>&nbsp;<input name="tiankongitem" type="radio" value="dizhi" cnname="地址" datatype="text" /></td>
    <td>&nbsp;5</td>
    <td>&nbsp;地址</td>
  </tr>
  <tr>
    <td>&nbsp;<input name="tiankongitem" type="radio" value="youbian" cnname="邮编" datatype="number" /></td>
    <td>&nbsp;6</td>
    <td>&nbsp;邮编</td>
  </tr>
  <tr>
    <td>&nbsp;<input name="tiankongitem" type="radio" value="dianhua" cnname="电话" datatype="text" /></td>
    <td>&nbsp;7</td>
    <td>&nbsp;电话</td>
  </tr>
  <tr>
    <td>&nbsp;<input name="tiankongitem" type="radio" value="riqi" cnname="日期" datatype="date" /></td>
    <td>&nbsp;8</td>
    <td>&nbsp;日期</td>
  </tr>
</table>
</div>
<div id="zidingyitiankong" style="display:none;">
<table width="100%" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td>中文名</td>
    <td><input type="text" name="cnname" /></td>
  </tr>
  <tr>
    <td>英文编码</td>
    <td><input type="text" name="enname" /></td>
  </tr>
  <tr>
    <td>数据类型</td>
    <td>
	<select onChange="biaogeshujuleixingdingyi(this)" name="datatype"><option value="text">文字</option><option value="number">数字</option><option value="date">日期</option><option value="money">金额</option></select>
	<span class="jinedaxie" style="display:none;"><input type="checkbox" name="jinedaxie" value="1" />绑定大写格式</span></td>
  </tr>
</table>

</div>
</div>


<div id="biaoge" style="display:none;background:#fff;">
预设行数：<input type="text" id="yushehangshu" name="yushehangshu" value="10"/><br/>
是否允许投标人增加表格行：<input type="radio" name="yunxuzengjiabiaogehang" value="0" checked="checked" />不允许
<input type="radio" name="yunxuzengjiabiaogehang" value="1" />允许
<div class="tabpage">
<ul>
<li class="selected" onClick="qiehuan(this,'biaoge',1);">常用表格</li>
<li onClick="qiehuan(this,'biaoge',2);">自定义</li>
</ul>
</div>
<div id="changyongbiaoge">
<table width="100%" border="1">
  <tr>
    <th scope="col">&nbsp;</th>
    <th scope="col">序号&nbsp;</th>
    <th scope="col">表格名称&nbsp;</th>
  </tr>
  <tr>
    <td>&nbsp;<input name="biaogeitem" type="radio" value="fuwuxiangmupianlibiao" cnname="服务项目偏离表" checked /></td>
    <td>&nbsp;1</td>
    <td>&nbsp;服务项目偏离表</td>
  </tr>
  <tr>
    <td>&nbsp;<input name="biaogeitem" type="radio" value="jishuguifanpianlibiao" cnname="技术规范偏离表" /></td>
    <td>&nbsp;2</td>
    <td>&nbsp;技术规范偏离表</td>
  </tr>
  <tr>
    <td>&nbsp;<input name="biaogeitem" type="radio" value="gongchengjijishufuwufeiyong" cnname="工程及技术服务费用" /></td>
    <td>&nbsp;3</td>
    <td>&nbsp;工程及技术服务费用</td>
  </tr>
  <tr>
    <td>&nbsp;<input name="biaogeitem" type="radio" value="huanbaobiaozhichanpinmingxibiao" cnname="环保标志产品明细表" /></td>
    <td>&nbsp;4</td>
    <td>&nbsp;环保标志产品明细表</td>
  </tr>
  <tr>
    <td>&nbsp;<input name="biaogeitem" type="radio" value="jienengchanpinmingxibiao" cnname="节能产品明细表" /></td>
    <td>&nbsp;5</td>
    <td>&nbsp;节能产品明细表</td>
  </tr>
</table>
</div>
<div id="zidingyibiaoge" style="display:none;">
表格名称：<input type="text" name="tablecnname" />
英文编号：<input type="text" name="tableenname" />
<table id="definetable" width="100%" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td>列号&nbsp;</td>
    <td>用途&nbsp;</td>
    <td>表头标题&nbsp;</td>
    <td>填写的数据要求&nbsp;</td>
	<td>&nbsp;</td>
  </tr>
  <tr>
    <td>1</td>
    <td><select name="lieyongtu" onChange="changeLieyongtu(this);"><option value="1">显示</option>
	<option value="2" selected="selected">填写</option></select></td>
    <td><input type="text" name="biaotoubiaoti"/></td>
    <td><span><select onChange="biaogeshujuleixingdingyi(this)" name="datatype"><option value="text">文字</option><option value="number">数字</option><option value="date">日期</option><option value="money">金额</option></select>
	<span class="jinedaxie" style="display:none;"><input type="checkbox" name="jinedaxie" value="1" />绑定大写格式</span></span>
	</td>
    <td>删除</td>
  </tr>
</table>
<input type="button" value="增加列" onClick="zengjiashujulie()"/>
<script type="text/javascript">
    function zengjiashujulie(){
	    var tbl=document.getElementById('definetable');
		var rowno = tbl.rows.length;
		var tr = tbl.insertRow(tbl.rows.length)
		var td = tr.insertCell(0);
		td.innerHTML=rowno;
		td = tr.insertCell(1);
		td.innerHTML='<select name="lieyongtu"><option value="1">显示</option><option value="2" selected="selected">填写</option></select>';
		td = tr.insertCell(2);
		td.innerHTML='<input type="text" name="biaotoubiaoti"/>';
		td = tr.insertCell(3);
		td.innerHTML='<span><select onChange="biaogeshujuleixingdingyi(this)" name="datatype"><option value="text">文字</option><option value="number">数字</option><option value="date">日期</option><option value="money">金额</option></select>	<span class="jinedaxie" style="display:none;"><input type="checkbox" name="jinedaxie" value="1" />绑定大写格式</span></span>';
		td = tr.insertCell(4);
		td.innerHTML='删除';
	}
	
	function changeLieyongtu(slt){
	    var s=slt.parentNode.parentNode.cells[3].childNodes[0];
	    if(slt.value!='2'){
		    s.style.display = 'none';
		}else{
		    s.style.display = '';
		}
	}
</script>
</div>
</div>
<div id="tupian" style="display:none;">
<br/>
<label>是否允许上传多个图片：</label><input name="duotupian" type="radio" value="0" checked="checked" />不允许 <input name="duotupian" type="radio" value="1" />允许
</div>
<div id="wendang" style="display:none;">
<br/>
<label>是否允许上传多个文档：</label><input name="duowendang" type="radio" value="0" checked="checked" />不允许 <input name="duowendang" type="radio" value="1" />允许
</div>

</body>
</html>
